{"title":"apache2.4版本与2.2版本的差异","slug":"linux/apache2.4版本与2.2版本的差异","date":"2016-05-06T01:41:22.000Z","updated":"2018-04-22T09:29:32.872Z","comments":true,"path":"api/articles/linux/apache2.4版本与2.2版本的差异.json","excerpt":null,"covers":null,"content":"<ul>\n<li>在2.2版本中<code>eventMPM</code>还处于测试阶段，而2.4版本<code>event</code>已经可以正常使用了</li>\n<li>2.4版本的3个MPM工作模式使用的是DSO动态模块来实现的，而2.2则是直接编译成了静态模块</li>\n<li>2.4版本切换MPM工作模式是在<code>/etc/httpd/conf.modules.d/00-mpm.conf</code>文件中实现的，而2.2版本则是在<code>/etc/sysconfig/httpd</code>文件中进行的切换</li>\n<li>2.4版本mod_userdir.c模块配置文件默认存放在<code>/etc/httpd/conf.d/userdir.conf</code> 中  ，而2.2版本则是在主配置文件<code>/etc/httpd/conf/httpd.conf</code>文件中</li>\n<li>2.4版本在对目录进行访问控制设置时使用的语句如下：</li>\n</ul>\n<p>基于IP的访问控制:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">无明确授权的目录，默认拒绝</span><br><span class=\"line\">允许所有主机访问：Require all granted</span><br><span class=\"line\">拒绝所有主机访问：Require all denied</span><br></pre></td></tr></table></figure></p>\n<p>控制特定的IP访问：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Require ip IPADDR：授权指定来源的IP访问</span><br><span class=\"line\">Require not ip IPADDR：拒绝特定的IP访问</span><br></pre></td></tr></table></figure></p>\n<p>控制特定的主机访问：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Require host HOSTNAME：授权特定主机访问</span><br><span class=\"line\">Require not host HOSTNAME：拒绝</span><br><span class=\"line\">HOSTNAME：</span><br><span class=\"line\">FQDN：特定主机</span><br><span class=\"line\">domin.tld：指定域名下的所有主机</span><br></pre></td></tr></table></figure></p>\n<p>不能有失败，至少有一个成功匹配才成功，即失败优先<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;RequireAll&gt;</span><br><span class=\"line\">Require all granted</span><br><span class=\"line\">Require not ip 172.16.1.1 拒绝特定IP</span><br><span class=\"line\">&lt;/RequireAll&gt;</span><br></pre></td></tr></table></figure></p>\n<p>多个语句有一个成功，则成功，即成功优先<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;RequireAny&gt;</span><br><span class=\"line\">Require all denied</span><br><span class=\"line\">require ip 172.16.1.1 允许特定IP</span><br><span class=\"line\">&lt;/RequireAny&gt;</span><br></pre></td></tr></table></figure></p>\n<p>2.2版本在对目录进行访问控制设置时使用的语句如下：</p>\n<p>order和allow、deny放在directory, .htaccess中，order：定义生效次序；写在后面的表示默认法则<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Order allow,deny</span><br><span class=\"line\">Order deny,allow</span><br></pre></td></tr></table></figure></p>\n<p>Allow from和Deny from：定义客户端地址<br>客户端地址：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IP</span><br><span class=\"line\">网络: 172.16</span><br><span class=\"line\">172.16.0.0</span><br><span class=\"line\">172.16.0.0/16</span><br><span class=\"line\">172.16.0.0/255.255.0.0</span><br></pre></td></tr></table></figure></p>\n<p>实例：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;files &quot;*.txt&quot;&gt;</span><br><span class=\"line\">order deny,allow</span><br><span class=\"line\">deny from 172.16. 100.100</span><br><span class=\"line\">allow from 172.16</span><br><span class=\"line\">&lt;/files&gt;</span><br><span class=\"line\">&lt;files &quot;*.txt&quot;&gt;</span><br><span class=\"line\">order allow,deny</span><br><span class=\"line\">deny from 172.16.100.100</span><br><span class=\"line\">allow from 172.16</span><br><span class=\"line\">&lt;/files&gt;</span><br></pre></td></tr></table></figure></p>\n<p>注意：2.2版本和2.4版本对目录权限的控制两者语句不通用，用错不生效</p>\n<p>6、基于FQDN的虚拟主机配置中，2.4版本不需要“NameVirtualHost”标签头，而2.2版本的必须加。</p>\n<p>7、2.4版本的模板加载配置默认存放在<code>/etc/httpd/conf.modules.d/</code>下，而2.2版本则全部卸载了主配置文件<code>/etc/httpd/conf/httpd.conf</code>内</p>\n","more":"<ul>\n<li>在2.2版本中<code>eventMPM</code>还处于测试阶段，而2.4版本<code>event</code>已经可以正常使用了</li>\n<li>2.4版本的3个MPM工作模式使用的是DSO动态模块来实现的，而2.2则是直接编译成了静态模块</li>\n<li>2.4版本切换MPM工作模式是在<code>/etc/httpd/conf.modules.d/00-mpm.conf</code>文件中实现的，而2.2版本则是在<code>/etc/sysconfig/httpd</code>文件中进行的切换</li>\n<li>2.4版本mod_userdir.c模块配置文件默认存放在<code>/etc/httpd/conf.d/userdir.conf</code> 中  ，而2.2版本则是在主配置文件<code>/etc/httpd/conf/httpd.conf</code>文件中</li>\n<li>2.4版本在对目录进行访问控制设置时使用的语句如下：</li>\n</ul>\n<p>基于IP的访问控制:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">无明确授权的目录，默认拒绝</span><br><span class=\"line\">允许所有主机访问：Require all granted</span><br><span class=\"line\">拒绝所有主机访问：Require all denied</span><br></pre></td></tr></table></figure></p>\n<p>控制特定的IP访问：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Require ip IPADDR：授权指定来源的IP访问</span><br><span class=\"line\">Require not ip IPADDR：拒绝特定的IP访问</span><br></pre></td></tr></table></figure></p>\n<p>控制特定的主机访问：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Require host HOSTNAME：授权特定主机访问</span><br><span class=\"line\">Require not host HOSTNAME：拒绝</span><br><span class=\"line\">HOSTNAME：</span><br><span class=\"line\">FQDN：特定主机</span><br><span class=\"line\">domin.tld：指定域名下的所有主机</span><br></pre></td></tr></table></figure></p>\n<p>不能有失败，至少有一个成功匹配才成功，即失败优先<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;RequireAll&gt;</span><br><span class=\"line\">Require all granted</span><br><span class=\"line\">Require not ip 172.16.1.1 拒绝特定IP</span><br><span class=\"line\">&lt;/RequireAll&gt;</span><br></pre></td></tr></table></figure></p>\n<p>多个语句有一个成功，则成功，即成功优先<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;RequireAny&gt;</span><br><span class=\"line\">Require all denied</span><br><span class=\"line\">require ip 172.16.1.1 允许特定IP</span><br><span class=\"line\">&lt;/RequireAny&gt;</span><br></pre></td></tr></table></figure></p>\n<p>2.2版本在对目录进行访问控制设置时使用的语句如下：</p>\n<p>order和allow、deny放在directory, .htaccess中，order：定义生效次序；写在后面的表示默认法则<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Order allow,deny</span><br><span class=\"line\">Order deny,allow</span><br></pre></td></tr></table></figure></p>\n<p>Allow from和Deny from：定义客户端地址<br>客户端地址：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IP</span><br><span class=\"line\">网络: 172.16</span><br><span class=\"line\">172.16.0.0</span><br><span class=\"line\">172.16.0.0/16</span><br><span class=\"line\">172.16.0.0/255.255.0.0</span><br></pre></td></tr></table></figure></p>\n<p>实例：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;files &quot;*.txt&quot;&gt;</span><br><span class=\"line\">order deny,allow</span><br><span class=\"line\">deny from 172.16. 100.100</span><br><span class=\"line\">allow from 172.16</span><br><span class=\"line\">&lt;/files&gt;</span><br><span class=\"line\">&lt;files &quot;*.txt&quot;&gt;</span><br><span class=\"line\">order allow,deny</span><br><span class=\"line\">deny from 172.16.100.100</span><br><span class=\"line\">allow from 172.16</span><br><span class=\"line\">&lt;/files&gt;</span><br></pre></td></tr></table></figure></p>\n<p>注意：2.2版本和2.4版本对目录权限的控制两者语句不通用，用错不生效</p>\n<p>6、基于FQDN的虚拟主机配置中，2.4版本不需要“NameVirtualHost”标签头，而2.2版本的必须加。</p>\n<p>7、2.4版本的模板加载配置默认存放在<code>/etc/httpd/conf.modules.d/</code>下，而2.2版本则全部卸载了主配置文件<code>/etc/httpd/conf/httpd.conf</code>内</p>\n","categories":[{"name":"linux","path":"api/categories/linux.json"}],"tags":[{"name":"apache","path":"api/tags/apache.json"}]}